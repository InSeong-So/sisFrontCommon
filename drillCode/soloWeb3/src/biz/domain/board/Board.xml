<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
        PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
        "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap>

  <typeAlias alias="board" type="biz.domain.board.Board" />

  <insert id="insertBoard" parameterClass="board">
    <![CDATA[
      INSERT INTO BR0010
              (
                  SEQ_NO
                 ,TITLE
                 ,CONTENT
                 ,WRITER
                 ,WRITE_NO
                 ,REG_DATE
                 ,VIEW_CNT
              )
       VALUES ((SELECT NVL(MAX(SEQ_NO + 1), 1) FROM BR0010)
              ,#title#
              ,#content#
              ,#writer#
              ,(SELECT NVL(MAX(WRITE_NO + 1), 1)
                  FROM BR0010
                 WHERE WRITER = #writer#)
              ,SYSDATE
              ,0)
    ]]>
  </insert>

  <select id="getBoardList" resultClass="board">
    <![CDATA[
      SELECT SEQ_NO
            ,TITLE
            ,WRITER
            ,CONTENT
            ,WRITE_NO
            ,REG_DATE
            ,VIEW_CNT
        FROM BR0010
    ORDER BY SEQ_NO DESC
    ]]>
  </select>

  <select id="getContent" parameterClass="int"
    resultClass="board">
    <![CDATA[
      SELECT T1.TITLE
        ,T1.CONTENT
        ,T1.WRITER
        ,T1.WRITE_NO
        ,T1.REG_IP
        ,T1.VIEW_CNT
    FROM BR0010 T1
   WHERE T1.WRITER = #WRITER#
     AND T1.WRITE_NO = #WRITE_NO#
    ]]>
  </select>

  <update id="updateBoard" parameterClass="board">
    <![CDATA[
      UPDATE BR0010
         SET TITLE             = #title#
            ,CONTENT           = #content#
            ,MOD_DATE          = SYSDATE
       WHERE WRITER = #writer#
         AND WRITE_NO = #write_no#
    ]]>
  </update>

  <update id="setBoardViewCnt" parameterClass="board">
    <![CDATA[
      UPDATE BR0010
         SET VIEW_CNT          = #view_cnt#
       WHERE WRITER = #writer#
         AND WRITE_NO = #write_no#;
    ]]>
  </update>

  <delete id="deleteBoard" parameterClass="board">
    <![CDATA[
      DELETE FROM BR0010
            WHERE WRITER = #writer#
              AND WRITE_NO = #write_no#
    ]]>
  </delete>
  
</sqlMap>